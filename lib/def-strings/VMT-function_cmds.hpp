// -*- coding: utf-8 -*-

// Author: Leo Cabezas Amigo
// Course: nand2tetris II

#ifndef _VMT_FUNCTION_CMDS_HPP_
#define _VMT_FUNCTION_CMDS_HPP_

#define FUNCTION_STR \
"\
(FUNCTION_NAME)\n\
\
@NVARS\n\
D=A\n\
@R13\n\
M=D\n\
\
(_FUNCTION_LOOP_ID[X]_)\n\
@R13\n\
D=M\n\
@_FUNCTION_OUT_ID[X]_\n\
D;JEQ\n\
\
@0\n\
D=A\n\
@SP\n\
M=M+1\n\
A=M\n\
A=A-1\n\
M=D\n\
\
@R13\n\
M=M-1\n\
\
@_FUNCTION_LOOP_ID[X]_\n\
0;JMP\n\
(_FUNCTION_OUT_ID[X]_)\n\
"

#define CALL_STR \
"\
@RETURN_ADDRESS\n\
D=A\n\
@SP\n\
M=M+1\n\
A=M\n\
A=A-1\n\
M=D\n\
\
@LCL\n\
D=M\n\
@SP\n\
M=M+1\n\
A=M\n\
A=A-1\n\
M=D\n\
\
@ARG\n\
D=M\n\
@SP\n\
M=M+1\n\
A=M\n\
A=A-1\n\
M=D\n\
\
@THIS\n\
D=M\n\
@SP\n\
M=M+1\n\
A=M\n\
A=A-1\n\
M=D\n\
\
@THAT\n\
D=M\n\
@SP\n\
M=M+1\n\
A=M\n\
A=A-1\n\
M=D\n\
\
@SP\n\
D=M\n\
@5\n\
D=D-A\n\
@NARGS\n\
D=D-A\n\
@ARG\n\
M=D\n\
\
@SP\n\
D=M\n\
@LCL\n\
M=D\n\
\
@FUNCTION_NAME\n\
0;JMP\n\
\
(RETURN_ADDRESS)\n\
"

#define RETURN_STR \
"\
@SP\n\
M=M-1\n\
A=M\n\
D=M\n\
@ARG\n\
A=M\n\
M=D\n\
\
@ARG\n\
D=M\n\
@1\n\
D=D+A\n\
@SP\n\
M=D\n\
\
@LCL\n\
D=M-1\n\
@R13\n\
M=D\n\
A=D\n\
D=M\n\
@THAT\n\
M=D\n\
\
@R13\n\
M=M-1\n\
D=M\n\
A=D\n\
D=M\n\
@THIS\n\
M=D\n\
\
@R13\n\
M=M-1\n\
D=M\n\
A=D\n\
D=M\n\
@ARG\n\
M=D\n\
\
@R13\n\
M=M-1\n\
D=M\n\
A=D\n\
D=M\n\
@LCL\n\
M=D\n\
\
@R13\n\
M=M-1\n\
D=M\n\
A=D\n\
D=M\n\
\
A=D\n\
0;JMP\n\
"

#endif	// _VMT_FUNCTION_CMDS_HPP_
